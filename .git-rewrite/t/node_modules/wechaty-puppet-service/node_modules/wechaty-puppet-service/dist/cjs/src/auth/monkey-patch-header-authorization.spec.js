#!/usr/bin/env -S node --no-warnings --loader ts-node/esm
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tstest_1 = require("tstest");
const grpc_js_js_1 = require("./grpc-js.js");
const mokey_patch_header_authorization_js_1 = require("./mokey-patch-header-authorization.js");
(0, tstest_1.test)('monkeyPatchMetadataFromHttp2Headers', async (t) => {
    const AUTHORITY = '__authority__';
    const headers = {
        ':authority': AUTHORITY,
    };
    const dispose = (0, mokey_patch_header_authorization_js_1.monkeyPatchMetadataFromHttp2Headers)(grpc_js_js_1.Metadata);
    const meta = grpc_js_js_1.Metadata.fromHttp2Headers(headers);
    const authorization = meta.get('authorization')[0];
    const EXPECTED = `Wechaty ${AUTHORITY}`;
    t.equal(authorization, EXPECTED, 'should get authority from metadata');
    dispose();
});
//# sourceMappingURL=monkey-patch-header-authorization.spec.js.map