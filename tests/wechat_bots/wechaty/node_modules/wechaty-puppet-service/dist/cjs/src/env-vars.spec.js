#!/usr/bin/env -S node --no-warnings --loader ts-node/esm
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// tslint:disable:no-shadowed-variable
const tstest_1 = require("tstest");
const env_vars_js_1 = require("./env-vars.js");
/**
 * Huan(202108): compatible with old env var
 *  See: https://github.com/wechaty/wechaty-puppet-service/issues/156
 *
 * This feature will be removed after Dec 31, 2022
 */
(0, tstest_1.test)('WECHATY_PUPPET_SERVICE_AUTHORITY()', async (t) => {
    const EXPECTED_AUTHORITY = 'api.wechaty.io';
    const oldValue = process.env['WECHATY_SERVICE_DISCOVERY_ENDPOINT'];
    process.env['WECHATY_SERVICE_DISCOVERY_ENDPOINT'] = `https://${EXPECTED_AUTHORITY}`;
    const result = (0, env_vars_js_1.WECHATY_PUPPET_SERVICE_AUTHORITY)();
    t.equal(result, EXPECTED_AUTHORITY, 'should extract authority');
    process.env['WECHATY_SERVICE_DISCOVERY_ENDPOINT'] = oldValue;
});
//# sourceMappingURL=env-vars.spec.js.map