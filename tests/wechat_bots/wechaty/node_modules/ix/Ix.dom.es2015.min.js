(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :
    typeof define === 'function' && define.amd ? define(['Ix'], factory) :
    (factory(global.Ix = global.Ix || {}));
}(this, (function (exports) {/*
 *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
*****************************************************************************/
'use strict';function h(a){return this instanceof h?this:new h(a)};const k=a=>null!=a&&Object(a)===a;function l(a){return null!=a&&"function"===typeof a[Symbol.iterator]}const m=a=>k(a)&&"function"===typeof a.pipe&&"function"===typeof a._read&&"boolean"===typeof a.readable&&k(a._readableState),r=a=>k(a)&&"function"===typeof a.end&&"function"===typeof a._write&&"boolean"===typeof a.writable&&k(a._writableState);class t extends Error{constructor(a="The operation has been aborted"){super(a);Object.setPrototypeOf(this,t.prototype);Error.captureStackTrace(this,this.constructor);this.name="AbortError"}get [Symbol.toStringTag](){return"AbortError"}}function u(a){if(a&&a.aborted)throw new t;}Object.defineProperty(t,Symbol.hasInstance,{writable:!0,configurable:!0,value(a){return k(a)&&("AbortError"===a.constructor.name||"AbortError"===a[Symbol.toStringTag])}});class v{constructor(){this.m=!1;this.v=[];this.i=[]}[Symbol.asyncIterator](){return this}write(a){this._push({type:"value",value:a})}error(a){this._push({type:"error",error:a})}_push(a){if(this.m)throw Error("AsyncSink already ended");if(0<this.i.length){const {resolve:b,reject:c}=this.i.shift();"error"===a.type?c(a.error):b({done:!1,value:a.value})}else this.v.push(a)}next(){if(0<this.v.length){const {type:a,value:b,error:c}=this.v.shift();return"error"===a?Promise.reject(c):Promise.resolve({done:!1,
value:b})}return this.m?Promise.resolve({done:!0}):new Promise((a,b)=>{this.i.push({resolve:a,reject:b})})}end(){for(;0<this.i.length;)this.i.shift().resolve({done:!0});this.m=!0}};function w(a){return a}async function x(a){return a};function y(a,b){return"undefined"===typeof b?a:function(c,d){return a.call(b,c,d)}};function z(a){a=Number(a);return isNaN(a)?0:0!==a&&isFinite(a)?(0<a?1:-1)*Math.floor(Math.abs(a)):a};const A=Math.pow(2,53)-1;let B;function C(a){return a instanceof D?a:"string"===typeof a?new B([a]):l(a)||k(a)&&"number"===typeof a.length?new B(a):new B([a])};class D{forEach(a,b){a=y(a,b);b=0;for(const c of this)a(c,b++)}pipe(...a){let b=-1;const c=a.length;let d=this;for(;++b<c;)d=a[b](C(d));return d}}D.prototype[Symbol.toStringTag]="IterableX";Object.defineProperty(D,Symbol.hasInstance,{writable:!0,configurable:!0,value(a){return!(!a||"IterableX"!==a[Symbol.toStringTag])}});
(function(a){B=class extends a{constructor(b){super();this.g=b;this.A=w}*[Symbol.iterator](){let b=0;if(l(this.g))for(var c of this.g)yield this.A(c,b++);else for(c=Math.min(Math.max(z(this.g.length),0),A);b<c;)yield this.A(this.g[b],b++)}}})(D);
try{(a=>{if(!a){D.prototype.pipe=function(...c){let d=-1;const g=c.length;let f=this,e;for(;++d<g;)if(e=c[d],"function"===typeof e)f=e(C(f));else if(r(e))return{end:c=!0}=c[d+1]||{},m(f)?f.pipe(e,{end:c}):C(f).G(b(e)).pipe(e,{end:c});return f};var b=(c,d=c.D||{F:!0})=>d}})("object"===typeof window&&"object"===typeof document&&9===document.nodeType)}catch(a){};const E="function"===typeof Symbol&&Symbol.observable||"@@observable";let F,G,H,I;function J(a){return a instanceof K?a:"string"===typeof a?new F([a]):l(a)||k(a)&&"function"===typeof a[Symbol.asyncIterator]?new G(a):k(a)&&"function"===typeof a.then?new H(a):null!=a&&Object(a)===a&&"function"===typeof a.subscribe?new I(a):k(a)&&"number"===typeof a.length?new F(a):new F([a])};class L{constructor(a,b){this.g=a;this.u=b}[Symbol.asyncIterator](){return this.g[Symbol.asyncIterator](this.u)}}class K{async forEach(a,b,c){const d=c?new L(this,c):this;let g=0;for await(const f of d)await a.call(b,f,g++,c)}pipe(...a){let b=-1;const c=a.length;let d=this;for(;++b<c;)d=a[b](J(d));return d}}K.prototype[Symbol.toStringTag]="AsyncIterableX";Object.defineProperty(K,Symbol.hasInstance,{writable:!0,configurable:!0,value(a){return!(!a||"AsyncIterableX"!==a[Symbol.toStringTag])}});
(function(a){F=class extends a{constructor(b){super();this.g=b;this.h=x}async*[Symbol.asyncIterator](){let b=0;const c=Math.min(Math.max(z(this.g.length),0),A);for(;b<c;)yield await this.h(this.g[b],b++)}};G=class extends a{constructor(b){super();this.g=b;this.h=x}async*[Symbol.asyncIterator](){let b=0;for await(const c of this.g)yield await this.h(c,b++)}};H=class extends a{constructor(b){super();this.g=b;this.h=x}async*[Symbol.asyncIterator](){const b=await this.g;yield await this.h(b,0)}};I=class extends a{constructor(b){super();
this.C=b;this.h=x}async*[Symbol.asyncIterator](b){function c(){d.error(new t)}u(b);const d=new v,g=this.C.subscribe({next(e){d.write(e)},error(e){d.error(e)},complete(){d.end()}});b&&b.addEventListener("abort",c);let f=0;try{for(let e;!(e=await d.next()).done;)u(b),yield await this.h(e.value,f++)}finally{b&&b.removeEventListener("abort",c),g.unsubscribe()}}}})(K);
try{(a=>{if(!a){K.prototype.pipe=function(...c){let d=-1;const g=c.length;let f=this,e;for(;++d<g;)if(e=c[d],"function"===typeof e)f=e(J(f));else if(r(e))return{end:c=!0}=c[d+1]||{},m(f)?f.pipe(e,{end:c}):J(f).G(b(e)).pipe(e,{end:c});return f};var b=(c,d=c.D||{F:!0})=>d}})("object"===typeof window&&"object"===typeof document&&9===document.nodeType)}catch(a){};function M(a,b){return a>b?1:a<b?-1:0};class N extends D{constructor(a){super();this.g=a}*[Symbol.iterator](){const a=Array.from(this.g),b=a.length,c=Array(b);for(let d=0;d<b;d++)c[d]=d;c.sort(this._getSorter(a));for(const d of c)yield a[d]}thenBy(a,b=M){return new O(this.g,a,b,!1,this)}thenByDescending(a,b=M){return new O(this.g,a,b,!0,this)}}
class O extends N{constructor(a,b,c,d,g){super(a);this.o=b;this.j=c;this.l=d;this.s=g}_getSorter(a,b){const c=a.map(this.o),d=this.j,g=this.s,f=this.l,e=(n,p)=>{const q=d(c[n],c[p]);return 0===q?b?b(n,p):n-p:f?-q:q};return g?g._getSorter(a,e):e}};class P extends K{constructor(a,b){super();this.g=a;this.u=b}[Symbol.asyncIterator](){return this.g[Symbol.asyncIterator](this.u)}};async function Q(a,b){u(b);const c=[];for await(const d of b?new P(a,b):a)c.push(d);return c};class R extends K{constructor(a){super();this.g=a}async*[Symbol.asyncIterator](a){u(a);a=await Q(this.g,a);const b=a.length,c=Array(b);for(let d=0;d<b;d++)c[d]=d;c.sort(this._getSorter(a));for(const d of c)yield a[d]}thenBy(a,b=M){return new S(this.g,a,b,!1,this)}thenByDescending(a,b=M){return new S(this.g,a,b,!0,this)}}
class S extends R{constructor(a,b,c,d,g){super(a);this.o=b;this.j=c;this.l=d;this.s=g}_getSorter(a,b){const c=a.map(this.o),d=this.j,g=this.s,f=this.l,e=(n,p)=>{const q=d(c[n],c[p]);return 0===q?b?b(n,p):n-p:f?-q:q};return g?g._getSorter(a,e):e}};var T={AbortError:t,AsyncSink:v,Iterable:D,AsyncIterable:K,symbolObservable:E};const U="undefined"!==typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;class V extends K{constructor(a){super();this.B=a}[Symbol.asyncIterator](){const a=this.B,b=a.getReader();return W(a,b,aa(b))}}class X extends V{[Symbol.asyncIterator](){var a=this.B;let b;try{b=a.getReader({mode:"byob"})}catch(c){return super[Symbol.asyncIterator]()}a=W(a,b,ba(b));a.next();return a}}
async function*W(a,b,c){let d=!1;try{yield*c}catch(g){(d=!0,b)&&await b.cancel(g)}finally{if(b&&(d||await b.cancel(),a.locked))try{b.closed.catch(()=>{}),b.releaseLock()}catch(g){}}}async function*aa(a){let b;for(;!(b=await a.read()).done;)yield b.value}async function*ba(a){var b;for(b=yield null;!(b=await ca(a,b)).done;)b=yield b.value}
async function ca(a,b){let c;if("number"===typeof b)c=new ArrayBuffer(b);else if(b instanceof ArrayBuffer)b=(c=b).byteLength;else if(b instanceof U)b=(c=b).byteLength;else return{done:!0,value:void 0};return await Y(a,c,0,b)}async function Y(a,b,c,d){if(c>=d)return{done:!1,value:new Uint8Array(b,0,d)};const {done:g,value:f}=await a.read(new Uint8Array(b,c,d-c));return(c+=f.byteLength)<d&&!g?await Y(a,f.buffer,c,d):{done:g,value:new Uint8Array(f.buffer,0,c)}};var Z={};Z.AbortError=t;Z.AsyncIterable=K;Z.AsyncIterableReadableByteStream=X;Z.AsyncIterableReadableStream=V;Z.AsyncSink=v;Z.Iterable=D;Z.OrderedAsyncIterable=S;Z.OrderedAsyncIterableBase=R;Z.OrderedIterable=O;Z.OrderedIterableBase=N;Z.default=T;Z.fromDOMStream=function(a,b){return b&&"byob"===b.mode?new X(a):new V(a)};Z.H=E;h.prototype[Symbol.toStringTag]="__await";Object.defineProperty(h,Symbol.hasInstance,{writable:!0,configurable:!0,value(a){return!(!a||"__await"!==a[Symbol.toStringTag])}});Object.assign(arguments[0],Z);}.bind(this))));

//# sourceMappingURL=Ix.dom.esnext.min.js.map
